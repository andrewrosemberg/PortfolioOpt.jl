<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Robust PO · PortfolioOpt.jl</title><link rel="canonical" href="https://andrewrosemberg.github.io/PortfolioOpt.jl/robust_po/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">PortfolioOpt.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Robust PO</a><ul class="internal"><li><a class="tocitem" href="#Motivation"><span>Motivation</span></a></li><li><a class="tocitem" href="#Background"><span>Background</span></a></li><li><a class="tocitem" href="#Problem-Definition"><span>Problem Definition</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Robust PO</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Robust PO</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/andrewrosemberg/PortfolioOpt.jl/blob/master/docs/src/robust_po.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Robust-Portfolio-Optimization"><a class="docs-heading-anchor" href="#Robust-Portfolio-Optimization">Robust Portfolio Optimization</a><a id="Robust-Portfolio-Optimization-1"></a><a class="docs-heading-anchor-permalink" href="#Robust-Portfolio-Optimization" title="Permalink"></a></h1><p><strong>Acknowledgements</strong>: Robust Formulations based on and inspired by Professor <a href="http://www.ind.puc-rio.br/en/equipe/davi-michel-valladao/">Davi M. Valladão</a>&#39;s lectures on &quot;Capital Market&quot;.</p><h2 id="Motivation"><a class="docs-heading-anchor" href="#Motivation">Motivation</a><a id="Motivation-1"></a><a class="docs-heading-anchor-permalink" href="#Motivation" title="Permalink"></a></h2><p>Portfolio Optimization (PO) formulations were developed to adapt to a variety of settings for decisions under uncertainty. These formulations depend on the available information of the uncertain data and the risk aversion of the decision-maker.</p><p>The available information for many market data (e.g. stock prices, future prices, etc) have non-stationary profiles that are hard to make statistical inference on. Thus, it can be hard to find good probability distributions needed for stochastic optimization. </p><p>One alternative approach is Robust Optimization.</p><h2 id="Background"><a class="docs-heading-anchor" href="#Background">Background</a><a id="Background-1"></a><a class="docs-heading-anchor-permalink" href="#Background" title="Permalink"></a></h2><p>Robust Optimization (RO) problems belong to the class of optimization under uncertainty problems where some problem data is uncertain (either because the decision is taken before the realization of the random event or because its observation is not available). Usual application cases for RO are when there isn’t sufficient information to derive probability distributions, but this isn’t strictly necessary. RO focuses on guaranteeing solution feasibility for any possible value of the uncertain data inside a defined Uncertainty Set. In the case where the uncertainty impacts the objective function, it guarantees optimality for the works case scenario considered in the Uncertainty Set.</p><p>Many uncertainty sets have been proposed to accommodate different levels of conservatism and data structures ([1]-[7]). A comparison of uncertainty sets to usual risk measures used in finance was made in [4] and [11].</p><p>A collection of recent contributions to robust portfolio strategies was made in [7 - 10]. Data-driven approaches to robust PO also gained interest in recent years and can be found in [12] - for a portfolio of stocks - and [13] - for a portfolio of future contracts. The results in those studies indicate promising alternatives for the integration between uncertain data and PO.</p><h2 id="Problem-Definition"><a class="docs-heading-anchor" href="#Problem-Definition">Problem Definition</a><a id="Problem-Definition-1"></a><a class="docs-heading-anchor-permalink" href="#Problem-Definition" title="Permalink"></a></h2><p>Simple versions of the Mean-Variance PO problem with robust uncertainty around the estimated mean returns are implemented by the following functions:</p><article class="docstring"><header><a class="docstring-binding" id="PortfolioOpt.po_min_variance_limit_return" href="#PortfolioOpt.po_min_variance_limit_return"><code>PortfolioOpt.po_min_variance_limit_return</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">po_min_variance_limit_return(formulation::AbstractPortfolioFormulation, R)</code></pre><p>Mean-Variance Portfolio Alocation (with a risk free asset). Posed as a quadratic convex problem. Minimizes worst case portfolio variance (<span>$V$</span>) and limit worst case portfolio return (<span>$R$</span>) in the uncertainty set (<span>$\Omega$</span>) to a minimal return parameter (<span>$R_0$</span>) normalized by current wealth (<span>$W_0$</span>).</p><p class="math-container">\[\begin{aligned}
\min_{w} \quad &amp; V \\
s.t. \quad &amp; R = (\min r&#39;w \; | \; r \in \Omega) \\
&amp; V = (\max w &#39; \Sigma w  \; | \; \Sigma \in \Omega) \\
&amp; R \geq R * W_0 \\
&amp; w \in \mathcal{X} \\
\end{aligned}\]</p><p>Where <span>$\mathcal{X}$</span> represents the additional constraints defined in the model by the user  (e.g. a limit on maximum invested money).</p><p>Arguments:</p><ul><li><code>formulation::AbstractPortfolioFormulation</code>: Struct containing atributes of formulation.</li><li><code>minimal_return::Real</code>: Minimal normalized return accepted.</li></ul><p>Optional Keywork Arguments:</p><ul><li><code>rf::Real = 0.0</code>: Risk-free return of money not invested.</li><li><code>current_wealth::Real = 1.0</code>: Current available wealth to be invested.</li><li><code>model::JuMP.Model = base_model(...)</code>: JuMP upper level portfolio optimization model. Defaults to a generic market specification.</li><li><code>w</code>: Portfolio optimization investment variable reference (&quot;weights&quot;).</li><li><code>portfolio_return::Function = portfolio_return!</code>: Function that calculates <span>$R$</span>. </li><li><code>portfolio_variance::Function = portfolio_variance!</code>: Function that calculates <span>$V$</span>. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/andrewrosemberg/PortfolioOpt.jl/blob/378d815f6105edc2b7fff4b7a5a5dabebb8183dd/src/mean_variance.jl#LL99-L122">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PortfolioOpt.po_max_return_limit_variance" href="#PortfolioOpt.po_max_return_limit_variance"><code>PortfolioOpt.po_max_return_limit_variance</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">po_max_return_limit_variance(formulation::AbstractPortfolioFormulation, V_0)</code></pre><p>Mean-Variance Portfolio Alocation (with a risk free asset). Posed as a quadratic convex problem. Maximizes worst case portfolio return (<span>$R$</span>) and limit worst case portfolio variance (<span>$V$</span>) in the uncertainty set (<span>$\Omega$</span>)  to a maximal risk parameter (<span>$V_0$</span>) normalized by current wealth (<span>$W_0$</span>).</p><p class="math-container">\[\begin{aligned}
\max_{w} \quad &amp; R \\
s.t. \quad &amp; R = (\min r&#39;w \; | \; r \in \Omega) \\
&amp; V \leq V_0 * W_0\\
&amp; V = (\max w &#39; \Sigma w  \; | \; \Sigma \in \Omega) \\
&amp; w \in \mathcal{X} \\
\end{aligned}\]</p><p>Where <span>$\mathcal{X}$</span> represents the additional constraints defined in the model by the user  (e.g. a limit on maximum invested money).</p><p>Arguments:</p><ul><li><code>formulation::AbstractPortfolioFormulation</code>: Struct containing atributes of formulation.</li><li><code>max_risk::Real</code>: Maximal normalized variance accepted.</li></ul><p>Optional Keywork Arguments:</p><ul><li><code>rf::Real = 0.0</code>: Risk-free return of money not invested.</li><li><code>current_wealth::Real = 1.0</code>: Current available wealth to be invested.</li><li><code>model::JuMP.Model = base_model(...)</code>: JuMP upper level portfolio optimization model. Defaults to a generic market specification.</li><li><code>w</code>: Portfolio optimization investment variable reference (&quot;weights&quot;).</li><li><code>portfolio_return::Function = portfolio_return!</code>: Function that calculates <span>$R$</span>. </li><li><code>portfolio_variance::Function = portfolio_variance!</code>: Function that calculates <span>$V$</span>. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/andrewrosemberg/PortfolioOpt.jl/blob/378d815f6105edc2b7fff4b7a5a5dabebb8183dd/src/mean_variance.jl#LL155-L178">source</a></section></article><h3 id="Bertsimas&#39;s-Uncertainty-Set"><a class="docs-heading-anchor" href="#Bertsimas&#39;s-Uncertainty-Set">Bertsimas&#39;s Uncertainty Set</a><a id="Bertsimas&#39;s-Uncertainty-Set-1"></a><a class="docs-heading-anchor-permalink" href="#Bertsimas&#39;s-Uncertainty-Set" title="Permalink"></a></h3><p>The uncertainty set proposed by Bertsimas in [6] is defined by the julia type (<a href="../api/#PortfolioOpt.RobustBertsimas"><code>RobustBertsimas</code></a>):</p><p class="math-container">\[\Omega = \left\{ \mu \; \middle| \begin{array}{ll}
s.t.  \quad \mu_i \leq \hat{r}_i + z_i \Delta_i \quad \forall i = 1:\mathcal{N} \\
\quad \quad \mu_i \geq \hat{r}_i - z_i \Delta_i  \quad \forall i = 1:\mathcal{N} \\
\quad \quad z_i \geq 0 \quad \forall i = 1:\mathcal{N} \\
\quad \quad z_i \leq 1 \quad \forall i = 1:\mathcal{N} \\
\quad \quad \sum_{i}^{\mathcal{N}} z_i \leq \Gamma \\
\end{array}
\right\} \\\]</p><p>where:</p><ul><li><span>$\hat{r}$</span>: Predicted mean of returns.</li><li><span>$\Delta$</span>: Uncertainty around mean.</li><li><span>$\Gamma$</span>: Budjet (sometimes interpreted as number of assets in worst case).</li><li><span>$\Sigma$</span>: Predicted covariance of returns.</li></ul><p>When the previously described problem definition functions are dispatched on this type (referred to as a formulation), a JuMP expression defining the worst case return (<span>$R$</span>) is returned by the function (<a href="../api/#PortfolioOpt.portfolio_return!-Tuple{Model,Any,RobustBertsimas}"><code>portfolio_return!(model::JuMP.Model, w, formulation::RobustBertsimas)</code></a>). In this case, <span>$R$</span> in the described uncertainty set is defined by the following primal problem:  </p><p class="math-container">\[\begin{aligned}
\min_{\mu, z} \quad &amp; \mu &#39; w \\
s.t. \quad &amp; \mu_i \leq \hat{r}_i + z_i \Delta_i \quad \forall i = 1:\mathcal{N} \quad &amp;: \pi^-_i \\
&amp; \mu_i \geq \hat{r}_i - z_i \Delta_i  \quad \forall i = 1:\mathcal{N} \quad &amp;: \pi^+_i \\
&amp; z_i \geq 0 \quad \forall i = 1:\mathcal{N} \\
&amp; z_i \leq 1 \quad \forall i = 1:\mathcal{N} \quad &amp;: \theta_i \\
&amp; \sum_{i}^{\mathcal{N}} z_i \leq \Gamma \quad : \lambda \\
\end{aligned}\]</p><p>However, the above equations cannot be directly incorporated in the upper-level problem since no of-the-shelf solver can solve the resulting bi-level (&quot;MinMax&quot;) optimization problem. Moreover, our case becomes even harder given the variable multiplication of the upper-level variabel (<span>$w$</span>) with the lower-level decision variable (<span>$\mu$</span>) in the objective function of the primal problem. The solution to this issue is to use of the following equivalent dual problem:</p><p class="math-container">\[\begin{aligned}
\max_{\lambda, \pi^-, \pi^+, \theta} \quad &amp;  \sum_{i}^{\mathcal{N}} (\hat{r}_i (\pi^+_i - \pi^-_i) - \theta_i ) - \Gamma \lambda\\
s.t.  \quad &amp; w_i = \pi^+_i - \pi^-_i  \quad \forall i = 1:\mathcal{N} \\
&amp;  \Delta_i (\pi^+_i + \pi^-_i) - \theta_i \leq \lambda \quad \forall i = 1:\mathcal{N} \\
&amp; \lambda \geq 0 , \; \pi^- \geq 0 , \; \pi^+ \geq 0 , \; \theta \geq 0 \\
\end{aligned}\]</p><p>Moreover, to avoid having a bi-level optimization problem, we replace the lower-level problem by its objective function expression and enforece the dual constraints in the upper-level problem, defining a lower bound for the optimal value (which will be exact if the upper-level problem requires). </p><p>In the meantime, the worst case variance, is calculated as in a usual Mean Variance PO since this uncertainty set does not imply any uncertainty about the covariance matrix (<a href="../api/#PortfolioOpt.portfolio_variance!-Tuple{Model,Any,AbstractMeanVariance}"><code>portfolio_variance!(::JuMP.Model, w, ::RobustBertsimas)</code></a>): <span>$w &#39; \Sigma w$</span>.</p><p>Finally, for instance, the resulting &quot;Maximization of Returns&quot; problem (<a href="#PortfolioOpt.po_max_return_limit_variance"><code>po_max_return_limit_variance</code></a>) becomes:</p><p class="math-container">\[\begin{aligned}
\max_{w, \lambda, \pi^-, \pi^+, \theta} \quad &amp; R \\
s.t. \quad &amp; R = \sum_{i}^{\mathcal{N}} (\hat{r}_i (\pi^+_i \pi^-_i) - \theta_i ) - \Gamma \lambda \\
&amp; w_i = \pi^+_i - \pi^-_i  \quad \forall i = 1:\mathcal{N} \\
&amp;  \Delta_i (\pi^+_i + \pi^-_i) - \theta_i \leq \lambda \quad \forall i = 1:\mathcal{N} \\\\
&amp; w &#39; \Sigma w  \leq V_0 * W_0 \\
&amp; \lambda \geq 0 , \; \pi^- \geq 0 , \; \pi^+ \geq 0 , \; \theta \geq 0 \\
&amp; w \in \mathcal{X} \\
\end{aligned}\]</p><h4 id="Vizualization-and-Special-Case-(Soyster&#39;s-Uncertainty-Set)"><a class="docs-heading-anchor" href="#Vizualization-and-Special-Case-(Soyster&#39;s-Uncertainty-Set)">Vizualization and Special Case (Soyster&#39;s Uncertainty Set)</a><a id="Vizualization-and-Special-Case-(Soyster&#39;s-Uncertainty-Set)-1"></a><a class="docs-heading-anchor-permalink" href="#Vizualization-and-Special-Case-(Soyster&#39;s-Uncertainty-Set)" title="Permalink"></a></h4><p>In order to visualize Bertsimas&#39;s uncertainty set, it&#39;s useful to plot the case with only two assets. For instance, when the budjet parameter is equal to one (<span>$\Gamma = 1$</span>) the resulting feasible region of the uncertaity set only allows one asset to be in its extreme value:</p><p><img src="https://github.com/andrewrosemberg/PortfolioOpt/blob/master/docs/src/assets/set_bertsimas.png?raw=true" alt/></p><p>On the other hand, when the budjet parameter is equal to the number of assets (<span>$\Gamma = 2$</span>), the uncertainty set becomes similar to the one proposed by Soyster in [1], i.e. box uncertainty:</p><p><img src="https://github.com/andrewrosemberg/PortfolioOpt/blob/master/docs/src/assets/set_soyster.png?raw=true" alt/></p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><p>[1] Soyster, A.L. Convex programming with set-inclusive constraints and applications to inexact linear programming. Oper. Res. 1973, 21, 1154–1157.</p><p>[2] Ben-Tal, A. e Nemirovski, A. (1999). Robust solutions of uncertain linear programs. Operations research letters, 25(1):1–13. </p><p>[3] Ben-Tal, A. e Nemirovski, A. (2000). Robust solutions of linear programming problems contaminated with uncertain data. Mathematical programming, 88(3):411–424. </p><p>[4] Bertsimas, D. e Brown, D. B. (2009). Constructing uncertainty sets for robust linear optimization. Operations research, 57(6):1483–1495. </p><p>[5] Bertsimas, D. e Pachamanova, D. (2008). Robust multiperiod portfolio management in the presence of transaction costs. Computers &amp; Operations Research, 35(1):3–17. </p><p>[6] Bertsimas, D. e Sim, M. (2004). The price of robustness. Operations research, 52(1):35–53. </p><p>[7] Bertsimas, D. e Sim, M. (2006). Tractable approximations to robust conic optimization problems. Mathematical programming, 107(1-2):5–36. </p><p>[8] Fabozzi, F. J., Huang, D., e Zhou, G. (2010). Robust portfolios: contributions from operations research and finance. Annals of Operations Research, 176(1):191–220. </p><p>[9] Fabozzi, F. J., Kolm, P. N., Pachamanova, D. A., e Focardi, S. M. (2007). Robust portfolio optimization. Journal of Portfolio Management, 33(3):40. </p><p>[10] Kim, J. H., Kim, W. C., e Fabozzi, F. J. (2014). Recent developments in robust portfolios with a worst-case approach. Journal of Optimization Theory and Applications, 161(1):103–121.</p><p>[11] Natarajan, K., Pachamanova, D., e Sim, M. (2009). Constructing risk measures from uncertainty sets. Operations research, 57(5):1129–1141.</p><p>[12] Fernandes, B., Street, A., ValladA˜ £o, D., e Fernandes, C. (2016). An adaptive robust portfolio optimization model with loss constraints based on data-driven polyhedral uncertainty sets. European Journal of Operational Research, 255(3):961 – 970. ISSN 0377-2217. <a href="www.sciencedirect.com/science/article/pii/S0377221716303757">URL</a>.</p><p>[13] Futures Contracts Portfolio Selection via Robust Data Driven Optimization publication date Aug 9, 2018  publication descriptionL SBPO, 2018, Rio de Janeiro. Anais do L SBPO, 2018. v. 1. <a href="https://proceedings.science/sbpo/papers/selecao-de-carteira-de-contratos-futuros-via-otimizacao-robusta-direcionado-por-dados">URL</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../examples/">Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 11 December 2020 21:19">Friday 11 December 2020</span>. Using Julia version 1.0.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
