<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Robust PO · PortfolioOpt.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://andrewrosemberg.github.io/PortfolioOpt.jl/robust_po/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">PortfolioOpt.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Robust PO</a><ul class="internal"><li><a class="tocitem" href="#Motivation"><span>Motivation</span></a></li><li><a class="tocitem" href="#Background"><span>Background</span></a></li><li><a class="tocitem" href="#Problem-Definition"><span>Problem Definition</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/distributionally_robust_optimization/">Distributionally Robust Portfolio Optimization</a></li><li><a class="tocitem" href="../examples/robust_optimization/">Robust Portfolio Optimization</a></li><li><a class="tocitem" href="../examples/stochastic_optimization/">Stochastic Portfolio Optimization</a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Robust PO</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Robust PO</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/andrewrosemberg/PortfolioOpt.jl/blob/master/docs/src/robust_po.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Robust-Portfolio-Optimization"><a class="docs-heading-anchor" href="#Robust-Portfolio-Optimization">Robust Portfolio Optimization</a><a id="Robust-Portfolio-Optimization-1"></a><a class="docs-heading-anchor-permalink" href="#Robust-Portfolio-Optimization" title="Permalink"></a></h1><p><strong>Acknowledgements</strong>: Robust Formulations based on and inspired by Professor <a href="http://www.ind.puc-rio.br/en/equipe/davi-michel-valladao/">Davi M. Valladão</a>&#39;s lectures on &quot;Capital Market&quot;.</p><h2 id="Motivation"><a class="docs-heading-anchor" href="#Motivation">Motivation</a><a id="Motivation-1"></a><a class="docs-heading-anchor-permalink" href="#Motivation" title="Permalink"></a></h2><p>Portfolio Optimization (PO) formulations were developed to adapt to a variety of settings for decisions under uncertainty. These formulations depend on the available information of the uncertain data and the risk aversion of the decision-maker.</p><p>The available information for many market data (e.g. stock prices, future prices, etc) have non-stationary profiles that are hard to make statistical inference on. Thus, it can be hard to find good probability distributions needed for stochastic optimization. </p><p>One alternative approach is Robust Optimization.</p><h2 id="Background"><a class="docs-heading-anchor" href="#Background">Background</a><a id="Background-1"></a><a class="docs-heading-anchor-permalink" href="#Background" title="Permalink"></a></h2><p>Robust Optimization (RO) problems belong to the class of optimization under uncertainty problems where some problem data is uncertain (either because the decision is taken before the realization of the random event or because its observation is not available). Usual application cases for RO are when there isn’t sufficient information to derive probability distributions, but this isn’t strictly necessary. RO focuses on guaranteeing solution feasibility for any possible value of the uncertain data inside a defined Uncertainty Set. In the case where the uncertainty impacts the objective function, it guarantees optimality for the works case scenario considered in the Uncertainty Set.</p><p>Many uncertainty sets have been proposed to accommodate different levels of conservatism and data structures ([1]-[7]). A comparison of uncertainty sets to usual risk measures used in finance are included in [4] and [11].</p><p>A collection of recent contributions to robust portfolio strategies are outlined in [7 - 10]. Data-driven approaches to robust PO has also gained interest in recent years and can be found in [12] - for a portfolio of stocks - and [13] - for a portfolio of future contracts. The results of these studies indicate promising alternatives for the integration of uncertain data in PO.</p><h2 id="Problem-Definition"><a class="docs-heading-anchor" href="#Problem-Definition">Problem Definition</a><a id="Problem-Definition-1"></a><a class="docs-heading-anchor-permalink" href="#Problem-Definition" title="Permalink"></a></h2><p>A simple version of the Mean-Variance Portfolio Allocation with robust uncertainty around the estimated mean returns (posed as a quadratic convex problem):</p><p class="math-container">\[\begin{aligned}
    \max_{w} \quad &amp; R \\
    s.t. \quad &amp; R = (\min r&#39;w \; | \; r \in \Omega) \\
    &amp; w &#39; \Sigma w \leq V_0 * W_0\\
    &amp; w \in \mathcal{X} \\
\end{aligned}\]</p><p>Maximizes the worst case portfolio return (<span>$R$</span>) and limits the portfolio variance to a maximal risk parameter (<span>$V_0$</span>) normalized by current wealth (<span>$W_0$</span>).</p><p>Where <span>$\mathcal{X}$</span> represents the additional constraints defined in the model by the user (e.g. a limit on maximum invested money).</p><p>A julia object representing this problem can be instanciated by the following command:</p><pre><code class="language-julia hljs">formulation = PortfolioFormulation(MAX_SENSE,
    ObjectiveTerm(ExpectedReturn(Ω)),
    RiskConstraint(Variance(d), LessThan(V_0 * W_0)),
)</code></pre><p>where <code>d</code> is a <code>Sampleable</code> containing the estimated <code>\Sigma</code> matrix.</p><h3 id="Bertsimas&#39;s-Uncertainty-Set"><a class="docs-heading-anchor" href="#Bertsimas&#39;s-Uncertainty-Set">Bertsimas&#39;s Uncertainty Set</a><a id="Bertsimas&#39;s-Uncertainty-Set-1"></a><a class="docs-heading-anchor-permalink" href="#Bertsimas&#39;s-Uncertainty-Set" title="Permalink"></a></h3><p>The uncertainty set proposed by Bertsimas in [6] is defined by the julia type (<a href="../api/#PortfolioOpt.BudgetSet"><code>BudgetSet</code></a>):</p><p class="math-container">\[\Omega = \left\{ \mu \; \middle| \begin{array}{ll}
s.t.  \quad \mu_i \leq \hat{r}_i + z_i \Delta_i \quad \forall i = 1:\mathcal{N} \\
\quad \quad \mu_i \geq \hat{r}_i - z_i \Delta_i  \quad \forall i = 1:\mathcal{N} \\
\quad \quad z_i \geq 0 \quad \forall i = 1:\mathcal{N} \\
\quad \quad z_i \leq 1 \quad \forall i = 1:\mathcal{N} \\
\quad \quad \sum_{i}^{\mathcal{N}} z_i \leq \Gamma \\
\end{array}
\right\} \\\]</p><p>where:</p><ul><li><span>$\hat{r}$</span>: Predicted mean of returns.</li><li><span>$\Delta$</span>: Uncertainty around mean.</li><li><span>$\Gamma$</span>: Budget (sometimes interpreted as number of assets in worst case).</li><li><span>$\Sigma$</span>: Predicted covariance of returns.</li></ul><p>The equivalent JuMP expression defining the worst case return (<span>$R$</span>) considering this uncertainty set can be constructed by the function <code>calculate_measure!(measure::ExpectedReturn{BudgetSet}, w)</code>. In this case, <span>$R$</span> in the described uncertainty set is defined by the following primal problem:  </p><p class="math-container">\[\begin{aligned}
\min_{\mu, z} \quad &amp; \mu &#39; w \\
s.t. \quad &amp; \mu_i \leq \hat{r}_i + z_i \Delta_i \quad \forall i = 1:\mathcal{N} \quad &amp;: \pi^-_i \\
&amp; \mu_i \geq \hat{r}_i - z_i \Delta_i  \quad \forall i = 1:\mathcal{N} \quad &amp;: \pi^+_i \\
&amp; z_i \geq 0 \quad \forall i = 1:\mathcal{N} \\
&amp; z_i \leq 1 \quad \forall i = 1:\mathcal{N} \quad &amp;: \theta_i \\
&amp; \sum_{i}^{\mathcal{N}} z_i \leq \Gamma \quad : \lambda \\
\end{aligned}\]</p><p>However, the above equations cannot be directly incorporated in the upper-level problem since no of-the-shelf solver can solve the resulting bi-level (&quot;MinMax&quot;) optimization problem. Moreover, our case becomes even harder given the variable multiplication of the upper-level variable (<span>$w$</span>) with the lower-level decision variable (<span>$\mu$</span>) in the objective function of the primal problem. The solution to this issue is to use of the following equivalent dual problem:</p><p class="math-container">\[\begin{aligned}
\max_{\lambda, \pi^-, \pi^+, \theta} \quad &amp;  \sum_{i}^{\mathcal{N}} (\hat{r}_i (\pi^+_i - \pi^-_i) - \theta_i ) - \Gamma \lambda\\
s.t.  \quad &amp; w_i = \pi^+_i - \pi^-_i  \quad \forall i = 1:\mathcal{N} \\
&amp;  \Delta_i (\pi^+_i + \pi^-_i) - \theta_i \leq \lambda \quad \forall i = 1:\mathcal{N} \\
&amp; \lambda \geq 0 , \; \pi^- \geq 0 , \; \pi^+ \geq 0 , \; \theta \geq 0 \\
\end{aligned}\]</p><p>Moreover, to avoid having a bi-level optimization problem, we replace the lower-level problem by its objective function expression and enforce the dual constraints in the upper-level problem, defining a lower bound for the optimal value (which will be exact if the upper-level problem requires). </p><p>Finally, for instance, the resulting problem becomes:</p><p class="math-container">\[\begin{aligned}
\max_{w, \lambda, \pi^-, \pi^+, \theta} \quad &amp; R \\
s.t. \quad &amp; R = \sum_{i}^{\mathcal{N}} (\hat{r}_i (\pi^+_i \pi^-_i) - \theta_i ) - \Gamma \lambda \\
&amp; w_i = \pi^+_i - \pi^-_i  \quad \forall i = 1:\mathcal{N} \\
&amp;  \Delta_i (\pi^+_i + \pi^-_i) - \theta_i \leq \lambda \quad \forall i = 1:\mathcal{N} \\\\
&amp; w &#39; \Sigma w  \leq V_0 * W_0 \\
&amp; \lambda \geq 0 , \; \pi^- \geq 0 , \; \pi^+ \geq 0 , \; \theta \geq 0 \\
&amp; w \in \mathcal{X} \\
\end{aligned}\]</p><h4 id="Uncertainty-Set-Vizualization-and-Special-Case-(Soyster&#39;s-Uncertainty-Set)"><a class="docs-heading-anchor" href="#Uncertainty-Set-Vizualization-and-Special-Case-(Soyster&#39;s-Uncertainty-Set)">Uncertainty Set Vizualization and Special Case (Soyster&#39;s Uncertainty Set)</a><a id="Uncertainty-Set-Vizualization-and-Special-Case-(Soyster&#39;s-Uncertainty-Set)-1"></a><a class="docs-heading-anchor-permalink" href="#Uncertainty-Set-Vizualization-and-Special-Case-(Soyster&#39;s-Uncertainty-Set)" title="Permalink"></a></h4><p>In order to visualize Bertsimas&#39;s uncertainty set, it&#39;s useful to plot the case with only two assets. For instance, when the budget parameter is equal to one (<span>$\Gamma = 1$</span>) the resulting feasible region of the uncertaity set only allows one asset to be in its extreme value:</p><p><img src="https://github.com/andrewrosemberg/PortfolioOpt/blob/master/docs/src/assets/set_bertsimas.png?raw=true" alt/></p><p>On the other hand, when the budget parameter is equal to the number of assets (<span>$\Gamma = 2$</span>), the uncertainty set becomes similar to the one proposed by Soyster in [1], i.e. box uncertainty:</p><p><img src="https://github.com/andrewrosemberg/PortfolioOpt/blob/master/docs/src/assets/set_soyster.png?raw=true" alt/></p><h4 id="Building-Intuition-with-Efficient-Frontiers"><a class="docs-heading-anchor" href="#Building-Intuition-with-Efficient-Frontiers">Building Intuition with Efficient Frontiers</a><a id="Building-Intuition-with-Efficient-Frontiers-1"></a><a class="docs-heading-anchor-permalink" href="#Building-Intuition-with-Efficient-Frontiers" title="Permalink"></a></h4><p>Understanding the impacts on the final optimal portfolio given the uncertainty set is not trivial, but some easy analysis can help. One useful analysis is to plot the Efficient Frontier (EF) (a.k.a Pareto Frontier) for our optimization problems, which shows what are the optimal porfolios given our objective and constraints.</p><p>If we plot the EF for the classic mean-variance problem (Markoviz) as well as the closest robust portfolios (e.g. Bertsimas and Soyster), we can see that by expanding our uncertainty set (and consequently restricting further our problem), we get sub-optimal solutions for the non-robust problem:</p><p><img src="https://github.com/andrewrosemberg/PortfolioOpt/blob/master/docs/src/assets/pareto_markowitz.png?raw=true" alt/></p><p>Its also useful to see the EF for the respective robust problems since they have their own efficient frontier:</p><p><img src="https://github.com/andrewrosemberg/PortfolioOpt/blob/master/docs/src/assets/pareto_robust.png?raw=true" alt/></p><p>Notwithstanding the importance of looking at EF for specific objectives, its more useful to see the possible returns the portfolio from a certain strategy might have if we allow the asset returns to vary inside the uncertainty sets. For instance, lets allow returns to vary inside Bertsimas&#39; uncertainty set and see the consequences for Markowitz optimal portfolios and Bertsimas&#39; optimal portfolios:</p><p><img src="https://github.com/andrewrosemberg/PortfolioOpt/blob/master/docs/src/assets/uncertain_pareto_bertsimas.png?raw=true" alt/></p><p>Now we can cleary see the trade-off the robust portfolio is providing: a lower avarage return for a smaller range of possible portfolio return that is contained in the range of the non-robust counterpart.</p><p>Moreover, if we allow returns to vary inside Soyster&#39;s uncertainty set, we get the following frontiers:</p><p><img src="https://github.com/andrewrosemberg/PortfolioOpt/blob/master/docs/src/assets/uncertain_pareto_soyster.png?raw=true" alt/></p><p>Once again we get a lower avarage return for a smaller range of possible portfolio return that is contained in the range of the less-robust counterpart.</p><p>PS.: Code in <code>examples/test_effi_robust.jl</code>.</p><h3 id="Comming-Soon"><a class="docs-heading-anchor" href="#Comming-Soon">Comming Soon</a><a id="Comming-Soon-1"></a><a class="docs-heading-anchor-permalink" href="#Comming-Soon" title="Permalink"></a></h3><p>TODO: Ben-Tal&#39;s uncertainty set (<a href="../api/#PortfolioOpt.EllipticalSet"><code>EllipticalSet</code></a>)</p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><p>[1] Soyster, A.L. Convex programming with set-inclusive constraints and applications to inexact linear programming. Oper. Res. 1973, 21, 1154–1157.</p><p>[2] Ben-Tal, A. e Nemirovski, A. (1999). Robust solutions of uncertain linear programs. Operations research letters, 25(1):1–13. </p><p>[3] Ben-Tal, A. e Nemirovski, A. (2000). Robust solutions of linear programming problems contaminated with uncertain data. Mathematical programming, 88(3):411–424. </p><p>[4] Bertsimas, D. e Brown, D. B. (2009). Constructing uncertainty sets for robust linear optimization. Operations research, 57(6):1483–1495. </p><p>[5] Bertsimas, D. e Pachamanova, D. (2008). Robust multiperiod portfolio management in the presence of transaction costs. Computers &amp; Operations Research, 35(1):3–17. </p><p>[6] Bertsimas, D. e Sim, M. (2004). The price of robustness. Operations research, 52(1):35–53. </p><p>[7] Bertsimas, D. e Sim, M. (2006). Tractable approximations to robust conic optimization problems. Mathematical programming, 107(1-2):5–36. </p><p>[8] Fabozzi, F. J., Huang, D., e Zhou, G. (2010). Robust portfolios: contributions from operations research and finance. Annals of Operations Research, 176(1):191–220. </p><p>[9] Fabozzi, F. J., Kolm, P. N., Pachamanova, D. A., e Focardi, S. M. (2007). Robust portfolio optimization. Journal of Portfolio Management, 33(3):40. </p><p>[10] Kim, J. H., Kim, W. C., e Fabozzi, F. J. (2014). Recent developments in robust portfolios with a worst-case approach. Journal of Optimization Theory and Applications, 161(1):103–121.</p><p>[11] Natarajan, K., Pachamanova, D., e Sim, M. (2009). Constructing risk measures from uncertainty sets. Operations research, 57(5):1129–1141.</p><p>[12] Fernandes, B., Street, A., ValladA˜ £o, D., e Fernandes, C. (2016). An adaptive robust portfolio optimization model with loss constraints based on data-driven polyhedral uncertainty sets. European Journal of Operational Research, 255(3):961 – 970. ISSN 0377-2217. <a href="www.sciencedirect.com/science/article/pii/S0377221716303757">URL</a>.</p><p>[13] Futures Contracts Portfolio Selection via Robust Data Driven Optimization publication date Aug 9, 2018  publication descriptionL SBPO, 2018, Rio de Janeiro. Anais do L SBPO, 2018. v. 1. <a href="https://proceedings.science/sbpo/papers/selecao-de-carteira-de-contratos-futuros-via-otimizacao-robusta-direcionado-por-dados">URL</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../examples/distributionally_robust_optimization/">Distributionally Robust Portfolio Optimization »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Saturday 20 May 2023 23:55">Saturday 20 May 2023</span>. Using Julia version 1.9.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
